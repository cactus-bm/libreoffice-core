# @configure_input@
# FIXME: create 'install' and 'check' target

SHELL=/bin/sh

all: dmake/dmake@EXEEXT@ fetch
	@. ./*[Ee]nv.[Ss]et.sh && \
        cd instsetoo_native && \
        ../solenv/bin/build.pl -P@BUILD_NCPUS@ --all -- -P@BUILD_MAX_JOBS@

install:
	@. ./*[Ee]nv.[Ss]et.sh && \
	echo "Installing in $${prefix:-@prefix@}..."
	ooinstall "$${prefix:-@prefix@}" && \
	echo "" && \
	echo "Installation finished, you can now execute:" && \
	echo "$${prefix:-@prefix@}/program/soffice"

dev-install:
	@. ./*[Ee]nv.[Ss]et.sh && \
        ooinstall -l @abs_builddir@/install && \
        echo "" && \
        echo "Developer installation finished, you can now execute:" && \
        echo "@abs_builddir@/install/program/soffice"

distclean: dmake/dmake@EXEEXT@
	@. ./*[Ee]nv.[Ss]et.sh && \
        dmake distclean

clean: dmake/dmake@EXEEXT@
	@. ./*[Ee]nv.[Ss]et.sh && \
        dmake clean

dmake/dmake@EXEEXT@:
	@. ./*[Ee]nv.[Ss]et.sh && \
        ./bootstrap

src/downloaded: ooo.lst download
	@. ./*[Ee]nv.[Ss]et.sh && \
	$$SRC_ROOT/download $$SRC_ROOT/ooo.lst && touch $@

fetch: src/downloaded
