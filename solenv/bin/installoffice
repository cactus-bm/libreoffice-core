#*************************************************************************
# DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
# 
# Copyright 2008 by Sun Microsystems, Inc.
#
# OpenOffice.org - a multi-platform office productivity suite
#
# $RCSfile: installoffice,v $
#
# $Revision: 1.2 $
#
# This file is part of OpenOffice.org.
#
# OpenOffice.org is free software: you can redistribute it and/or modify
# it under the terms of the GNU Lesser General Public License version 3
# only, as published by the Free Software Foundation.
#
# OpenOffice.org is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU Lesser General Public License version 3 for more details
# (a copy is included in the LICENSE file that accompanied this code).
#
# You should have received a copy of the GNU Lesser General Public License
# version 3 along with OpenOffice.org.  If not, see
# <http://www.openoffice.org/license.html>
# for a copy of the LGPLv3 License.
#***********************************************************************/

#!/bin/sh
EXIT_SUCCESS=0
EXIT_FAILURE=1
EXIT_ERROR=2
EXIT_BUG=10

if [ x${SOLARENV}x = xx ]; then
    echo No environment found, please use 'configure' or 'setsolar'
    exit $EXIT_FAILURE
fi
usage() {
        echo "Usage: $SCRIPTNAME [-t DESTPATH] [-o] [-d]" >&2
        echo "" >&2
        echo "[-t] target path: path wehre tho office should installed to. The default is '$DESTPATH'" >&2
        echo "" >&2
        echo "[-o] force OpenOffice.org installation instead of StarOffice" >&2
        echo "" >&2
        echo "[-d] installation with debug output" >&2
        exit $EXIT_FAILURE
}

DESTPATH=/tmp/$USER
DEBUG=false
OOO=false

while getopts ':m:dho' OPTION ; do
        case $OPTION in
        d)        DEBUG=true
                ;;
        o)        OOO=true
                ;;
        t)        DESTPATH="$OPTARG"
                ;;
        h)        usage $EXIT_SUCCESS
                ;;
        \?)        echo "unkown option \"-$OPTARG\"." >&2
                usage $EXIT_ERROR
                ;;
        *)        echo "this is not possible...">&2
                usage $EXIT_BUG
                ;;
        esac
done

shift `expr $OPTIND - 1`

LOCALINSTALLDIR=$DESTPATH/office
LOCALUNPACKDIR=$DESTPATH/unpack

export LOCALINSTALLDIR
export LOCALUNPACKDIR

echo "### $SOLARENV/bin/installoffice.pl -debug $DEBUG $@"
exec perl -w $SOLARENV/bin/installoffice.pl -debug $DEBUG -ooo $OOO -cleanup true $@

exit $EXIT_SUCCESS