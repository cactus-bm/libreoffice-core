<HTML>
<HEAD>
<META NAME="GENERATOR" Content="Microsoft Developer Studio">
<META HTTP-EQUIV="Content-Type" content="text/html; charset=iso-8859-1">
<TITLE>Document Title</TITLE>
</HEAD>
<BODY id=theBody>

<script language="JScript">
// XEventListener implementation in JScript --------------------------------------------------
var factory= new ActiveXObject("com.sun.star.ServiceManager");
var oletest= factory.createInstance("oletest.OleTest");

var arFunctions= new Array();
arFunctions["methodByte"]= "sequence&lt;byte&gt; methodByte( [in] sequence&lt;byte&gt; aSeq )";
arFunctions["methodFloat"]= "sequence&lt;float&gt; methodFloat( [in] sequence&lt;float&gt; aSeq)";
arFunctions["methodDouble"]= "sequence&lt;double&gt; methodDouble( [in] sequence&lt;double&gt; aSeq)";
arFunctions["methodBool"]= 	"sequence&lt;boolean&gt; methodBool( [in] sequence&lt;boolean&gt; aSeq)";
arFunctions["methodShort"]= "sequence&lt;short&gt; methodShort( [in] sequence&lt;short&gt; aSeq)";
arFunctions["methodUShort"]= "sequence&lt;unsigned short&gt; methodUShort( [in] sequence&lt;unsigned short&gt; aSeq)";
arFunctions["methodLong"]= "sequence&lt;long&gt; methodLong( [in] sequence&lt;long&gt; aSeq)";
arFunctions["methodULong"]= "sequence&lt;unsigned long&gt; methodULong( [in] sequence&lt;unsigned long&gt; aSeq)";
arFunctions["methodString"]= "sequence&lt;string&gt; methodString( [in] sequence&lt;string&gt; aSeq)";
arFunctions["methodChar"]= "sequence&lt;char&gt; methodChar( [in] sequence&lt;char&gt; aSeq)";
arFunctions["methodAny"]= "sequence&lt;any&gt; methodAny	( [in] sequence&lt;any&gt; aSeq)";
arFunctions["methodXInterface"]= "sequence&lt;XInterface&gt; methodXInterface ( [in] sequence&lt;XInterface&gt; aSeq)";
arFunctions["methodSequence"]= "sequence&lt; sequence &lt;long&gt; &gt; methodSequence( [in] sequence&lt; sequence&lt; long &gt; &gt; aSeq)";
arFunctions["methodSequence2"]= "sequence&lt; sequence &lt;sequence &lt;long&gt; &gt; &gt; methodSequence2( [in] sequence&lt; sequence&lt; sequence&lt;long&gt; &gt; &gt; aSeq)";
arFunctions["methodXEventListeners"]= "sequence&lt; com::sun::star::lang::XEventListener &gt; methodXEventListeners( [in] sequence&lt;com::sun::star::lang::XEventListener&gt; aSeq)";
arFunctions["methodXEventListenersMul"]= "sequence&lt; sequence&lt; com::sun::star::lang::XEventListener &gt; &gt; methodXEventListenersMul( [in] sequence&lt; sequence&lt; com::sun::star::lang::XEventListener&gt; &gt; aSeq)";
arFunctions["AttrByte"]="[attribute] sequence<byte> AttrByte";
arFunctions["AttrFloat"]="[attribute] sequence<float> AttrFloat";
arFunctions["AttrDouble"]="[attribute] sequence<double> AttrDouble";
arFunctions["AttrBool"]="[attribute] sequence<boolean> AttrBool";
arFunctions["AttrShort"]="[attribute] sequence<short> AttrShort";
arFunctions["AttrUShort"]="[attribute] sequence<unsigned short> AttrUShort";
arFunctions["AttrLong"]="[attribute] sequence<long> AttrLong";
arFunctions["AttrULong"]="[attribute] sequence<unsigned long> AttrULong";
arFunctions["AttrString"]="[attribute] sequence<string> AttrString";
arFunctions["AttrChar"]="[attribute] sequence<char> AttrChar";
arFunctions["AttrAny"]="[attribute] sequence<any> AttrAny";
arFunctions["AttrSequence"]="[attribute] sequence< sequence<long> > AttrSequence";
arFunctions["AttrSequence2"]="[attribute] sequence< sequence< sequence <long> > > AttrSequence2";
arFunctions["AttrXInterface"]="[attribute] sequence< com::sun::star::uno::XInterface > AttrXInterface";

arFunctions["testout_methodByte"]= " void testout_methodByte( [out] byte rOut )";
arFunctions["testout_methodFloat"]= "void testout_methodFloat( [out] float rOut)";
arFunctions["testout_methodDouble"]= "void testout_methodDouble( [out] double rOut)";
arFunctions["testout_methodBool"]= "void testout_methodBool( [out] boolean rOut)";
arFunctions["testout_methodShort"]= "void testout_methodShort( [out] short rOut)";
arFunctions["testout_methodUShort"]= "void testout_methodUShort( [out] unsigned short rOut)";
arFunctions["testout_methodLong"]= "void testout_methodLong( [out]  long rOut)";
arFunctions["testout_methodULong"]= "void testout_methodULong( [out] unsigned long rOut)";
arFunctions["testout_methodString"]= "void testout_methodString( [out] string rOut)";
arFunctions["testout_methodChar"]= "void testout_methodChar( [out] char rOut)";
arFunctions["testout_methodAny"]= "void testout_methodAny( [out] any rOut)";
arFunctions["testout_methodSequence"]= "void testout_methodSequence( [out] sequence< long > rOut)";
arFunctions["testout_methodSequence2"]= "void testout_methodSequence2( [out] sequence < sequence< long > > rOut)";
arFunctions["testout_methodXInterface"]= "void testout_methodXInterface( [out] com::sun::star::uno::XInterface rOut)";
arFunctions["testout_methodMulParams1"]= "void testout_methodMulParams1( [out] long rout1, [out] long rout2)";
arFunctions["testout_methodMulParams2"]= "void testout_methodMulParams2( [out] long rout1, [out] long rout2, [out] string rout3)";
arFunctions["testout_methodMulParams3"]= "void testout_methodMulParams3( [in] string sin, [out] string sout)";
arFunctions["testout_methodMulParams4"]= "void testout_methodMulParams4( [in] float in1, [out] float out1, [in] long in2, [out] long out2, [in] long in3)";
arFunctions["testinout_methodByte"]="void testinout_methodByte( [inout] byte rOut )";
arFunctions["testinout_methodFloat"]="void testinout_methodFloat( [inout] float rOut)";
arFunctions["testinout_methodDouble"]="void testinout_methodDouble( [inout] double rOut)";
arFunctions["testinout_methodBool"]="void testinout_methodBool( [inout] boolean rOut)";
arFunctions["testinout_methodShort"]="void testinout_methodShort( [inout] short rOut)";
arFunctions["testinout_methodUShort"]="void testinout_methodUShort( [inout] unsigned short rOut)";
arFunctions["testinout_methodLong"]="void testinout_methodLong( [inout]  long rOut)";
arFunctions["testinout_methodULong"]="void testinout_methodULong( [inout] unsigned long rOut)";
arFunctions["testinout_methodString"]="void testinout_methodString( [inout] string rOut)";
arFunctions["testinout_methodChar"]="void testinout_methodChar( [inout] char rOut)";
arFunctions["testinout_methodAny"]="void testinout_methodAny( [inout] any rOut)";
arFunctions["testinout_methodSequence"]="void testinout_methodSequence( [inout] sequence< long > rOut)";
arFunctions["testinout_methodSequence2"]="void testinout_methodSequence2( [inout] sequence < sequence< long > > rOut)";
arFunctions["testinout_methodXInterface"]="void testinout_methodXInterface( [inout] com::sun::star::script::XInvocation rOut)";
arFunctions["testinout_methodXInterface2"]="void testinout_methodXInterface2( [inout] com::sun::star::uno::XInterface rOut)";

arFunctions["methodAnyTest1"]="any methodAnyTest1( [in] any rIn)";


var Log= new Logger();

var arr= new Array( 1, 2, 3, 4, 0);
var arrInt= new Array( 1,2,3,4,5);
var arrDouble= new Array( 1.2345, 12.345, 123.45, 1234.5, 12345);
var arrBool= new Array( true, false, true, false, true);
var arrChar= new Array( '1', 'A'," ", 55);

var arrString= new Array("hamburger","cheeseburger", "chicken nuggets", "chicken wings" , "pizza");
var arrAny= new Array( 100, 100.1235,"hallo");
var arrSeq= new Array( arr, arr, arr);
var arrSeq2= new Array( );

var arEventListener= new Array( new XEventListener_Impl(), new XEventListener_Impl(),
	                                new XEventListener_Impl());
var arEventListener2= new Array( new XEventListener_Impl(), new XEventListener_Impl(),
                                 new XEventListener_Impl());
var arArEventListener= new Array( arEventListener, arEventListener2);

var arObj= new Array();
for( i=0; i< 3; i++)
    arObj[i]= new Object();

var outVal= new Array();
var outVal2= new Array();
var outVal3= new Array();

for( i=0; i < 3; i++)
{
    arrSeq2[i]= new Array();
    for( j= 0; j < 3; j++)
    {
        arrSeq2[i][j]= new Array();
        for( k= 0; k < 5; k++)
        {
            arrSeq2[i][j][k]= (i * 3 * 5) + (j * 5) + k;
//            document.write(arrSeq2[i][j][k] + " ");
        }
//        document.write("<br>");
    }
}

    
ret= oletest.methodByte( arr); 
_ret= new VBArray( ret).toArray();
Log.print( isEqualAr( arr, _ret), "methodByte");

ret= oletest.methodFloat( arrDouble);
_ret= new VBArray( ret).toArray();
bOk= false;
if( (arrDouble.length == _ret.length)
    && (_ret[0] > 1.2344 && _ret[0] < 1.2346)
    && (_ret[1] > 12.344 && _ret[1] < 12.346)
    && (_ret[2] > 123.44 && _ret[2] < 123.46)
    && (_ret[3] > 1234.4 && _ret[3] < 1234.6)
    && (_ret[4] > 12344 && _ret[4] < 12346))
    bOk= true;
Log.print( bOk, "methodFloat");

ret= oletest.methodDouble( arrDouble);
_ret= new VBArray( ret).toArray();
Log.print( isEqualAr( arrDouble, _ret), "methodDouble");

ret= oletest.methodBool( arrBool); 
_ret= new VBArray( ret).toArray();
Log.print( isEqualAr( arrBool, _ret), "methodBool");

ret= oletest.methodShort( arr); 
_ret= new VBArray( ret).toArray();
Log.print( isEqualAr( arr, _ret), "methodShort");

ret= oletest.methodUShort( arr);
_ret= new VBArray( ret).toArray();
Log.print( isEqualAr( arr, _ret), "methodUShort");

ret= oletest.methodLong( arr); 
_ret= new VBArray( ret).toArray();
Log.print( isEqualAr( arr, _ret), "methodLong");

ret= oletest.methodULong( arr);
_ret= new VBArray( ret).toArray();
Log.print( isEqualAr( arr, _ret), "methodULong");

ret= oletest.methodChar( arrChar); 
_ret= new VBArray( ret).toArray();
bOk= false;
if( _ret.length == arrChar.length && _ret[0] == 49 && _ret[1] == 65 && _ret[2] == 32 && _ret[3] == 55)
    bOk= true;
Log.print( bOk, "methodChar");

ret= oletest.methodString( arrString); 
_ret= new VBArray( ret).toArray();	
Log.print( isEqualAr( arrString, _ret), "methodString");

ret= oletest.methodAny( arrAny);
_ret= new VBArray( ret).toArray();
Log.print( isEqualAr( arrAny, _ret), "methodAny");
		
ret= oletest.methodSequence( arrSeq);
_ret= new VBArray( ret).toArray();
for( i=0; i < _ret.length; i++)
{
    sfarray2= new VBArray( _ret[i]);    
    var arr2= sfarray2.toArray();
    if( ! isEqualAr(arrSeq[i], arr2))
    {
        bOk= false;
        break;
    }        
}
Log.print( bOk, "methodSequence");

ret= oletest.methodSequence2( arrSeq2);
arr1= new VBArray( ret).toArray();
for( i=0; i < arr1.length; i++)
{
    var ar2Dim= arrSeq2[i];
    sfarray2= new VBArray( arr1[i]);
    arr2= sfarray2.toArray();
    for ( j=0; j < arr2.length; j++)
    {
        var ar1Dim= ar2Dim[j];
        sfarray3= new VBArray( arr2[j]);
        arr3= sfarray3.toArray();
//        document.write(arr3[j].toString());
        if( ! isEqualAr( arrSeq2[i][j], arr3))
        {
             bOk= false;
             break;
        }
    }
}
Log.print( bOk, "methodSequence2");

ret= oletest.methodXInterface( arObj);
_ret= new VBArray( ret);
_ret= _ret.toArray();
bOk= true;
for(i in _ret)
{
    if( _ret[i] !== arObj[i])
    {
        bOk= false;
        break;
    }
}
Log.print( bOk, "methodXInterface");

ret= oletest.methodXEventListeners( arEventListener);
_ret= new VBArray(ret).toArray();
bOk= true;
for ( key in _ret)
{
    if( ! _ret[key].disposingCalled())
    {
        bOk= false;
        break;
    }
}
Log.print( bOk, "methodXEventListeners");

ret= oletest.methodXEventListenersMul( arArEventListener);
_ret= new VBArray(ret).toArray();
bOk= true;
for( key in _ret)
{
    _ret2= new VBArray(_ret[key]).toArray();
    for( key2 in _ret2)
    {
        if( ! _ret2[key2].disposingCalled())
        {
            bOk= false;
            break;
        }
    }
}
Log.print( bOk, "methodXEventListenersMul");

document.writeln("<br>");
oletest.AttrByte = arr;
ret= oletest.AttrByte;
_ret= new VBArray( ret).toArray();
Log.print( isEqualAr( arr, _ret), "AttrByte");

oletest.AttrFloat= arrDouble;
ret= oletest.AttrFloat;
_ret= new VBArray( ret).toArray();
bOk= false;
if( (arrDouble.length == _ret.length)
    && (_ret[0] > 1.2344 && _ret[0] < 1.2346)
    && (_ret[1] > 12.344 && _ret[1] < 12.346)
    && (_ret[2] > 123.44 && _ret[2] < 123.46)
    && (_ret[3] > 1234.4 && _ret[3] < 1234.6)
    && (_ret[4] > 12344 && _ret[4] < 12346))
    bOk= true;
Log.print( bOk, "AttrFloat");

oletest.AttrDouble= arrDouble;
ret= oletest.AttrDouble;
_ret= new VBArray( ret).toArray();
Log.print( isEqualAr( arrDouble, _ret), "AttrDouble");

oletest.AttrBool= arrBool;
ret= oletest.AttrBool;
_ret= new VBArray( ret).toArray();
Log.print( isEqualAr( arrBool, _ret), "AttrBool");

oletest.AttrShort= arr;
ret= oletest.AttrShort;
_ret= new VBArray( ret).toArray();
Log.print( isEqualAr( arr, _ret), "AttrShort");

oletest.AttrUShort= arr;
ret= oletest.AttrUShort;
_ret= new VBArray( ret).toArray();
Log.print( isEqualAr( arr, _ret), "AttrUShort");

oletest.AttrLong= arr;
ret= oletest.AttrLong;
_ret= new VBArray( ret).toArray();
Log.print( isEqualAr( arr, _ret), "AttrLong");

oletest.AttrULong= arr;
ret= oletest.AttrULong;
_ret= new VBArray( ret).toArray();
Log.print( isEqualAr( arr, _ret), "AttrULong");

oletest.AttrChar= arrChar;
ret= oletest.AttrChar;
_ret= new VBArray(ret).toArray();
bOk= false;
if( _ret.length == arrChar.length && _ret[0] == 49 && _ret[1] == 65 && _ret[2] == 32 && _ret[3] == 55)
    bOk= true;
Log.print( bOk, "AttrChar");

oletest.AttrString= arrString;
ret= oletest.AttrString;
_ret= new VBArray( ret).toArray();	
Log.print( isEqualAr( arrString, _ret), "AttrString");

oletest.AttrAny= arrAny;
ret= oletest.AttrAny;
_ret= new VBArray( ret).toArray();
Log.print( isEqualAr( arrAny, _ret), "AttrAny");

oletest.AttrSequence= arrSeq;
ret= oletest.AttrSequence;
_ret= new VBArray( ret).toArray();
for( i=0; i < _ret.length; i++)
{
    sfarray2= new VBArray( _ret[i]);    
    var arr2= sfarray2.toArray();
    if( ! isEqualAr(arrSeq[i], arr2))
    {
        bOk= false;
        break;
    }        
}
Log.print( bOk, "AttrSequence");

oletest.AttrSequence2= arrSeq2;
ret= oletest.AttrSequence2;
arr1= new VBArray( ret).toArray();
for( i=0; i < arr1.length; i++)
{
    var ar2Dim= arrSeq2[i];
    sfarray2= new VBArray( arr1[i]);
    arr2= sfarray2.toArray();
    for ( j=0; j < arr2.length; j++)
    {
        var ar1Dim= ar2Dim[j];
        sfarray3= new VBArray( arr2[j]);
        arr3= sfarray3.toArray();
        if( ! isEqualAr( arrSeq2[i][j], arr3))
        {
             bOk= false;
             break;
        }
    }
}
Log.print( bOk, "AttrSequence2");

oletest.AttrXInterface( arObj);
ret= oletest.AttrXInterface;
_ret= new VBArray( ret).toArray();
bOk= true;
for(i in _ret)
{
    if( _ret[i] !== arObj[i])
    {
        bOk= false;
        break;
    }
}
Log.print( bOk, "AttrXInterface");

document.writeln("<br>");

oletest.testout_methodByte( outVal );
Log.print( outVal[0] == 111, "testout_methodByte");

oletest.testout_methodFloat( outVal );
Log.print( outVal[0] > 3.13 && outVal[0] < 3.15, "testout_methodFloat");

oletest.testout_methodDouble( outVal );
Log.print( outVal[0] == 3.14, "testout_methodDouble" );

oletest.testout_methodBool( outVal );
Log.print( outVal[0] == true, "testout_methodBool");

oletest.testout_methodShort( outVal );
Log.print( outVal[0] == 222, "testout_methodShort");

oletest.testout_methodUShort( outVal );
Log.print( outVal[0] == 333, "testout_methodUShort");

oletest.testout_methodLong( outVal );
Log.print( outVal[0] == 444, "testout_methodLong");

oletest.testout_methodULong( outVal );
Log.print( outVal[0] == 555, "testout_methodULong");

oletest.testout_methodChar( outVal );
Log.print( outVal[0] == 65, "testout_methodChar");

oletest.testout_methodString( outVal );
Log.print( outVal[0] == "a little string", "testout_methodString");

oletest.testout_methodAny( outVal );
Log.print( outVal[0] == "I am a string in an any", "testout_methodAny");

oletest.testout_methodSequence( outVal );
var arr= new VBArray( outVal[0]).toArray();
Log.print( isEqualAr(arr, new Array( 0,1,2,3,4,5,6,7,8,9)), "testout_methodSequence");

oletest.testout_methodSequence2( outVal );
var arr= new VBArray( outVal[0]).toArray();
bOk= true;
if( arr.length= 10)
{    
    for( i=0; i < arr.length; i++)
    {
        var arr2= new VBArray( arr[i]).toArray();
        if( ! isEqualAr( arr2, new Array( 0,1,2,3,4,5,6,7,8,9)))
        {
            bOk= false;
            break;
        }
    }
}
Log.print( bOk, "testout_methodSequence2");

oletest.testout_methodMulParams1( outVal, outVal2 );
Log.print( outVal[0] == 999 && outVal2[0] == 1111, "testout_methodMulParams1");

oletest.testout_methodMulParams2( outVal, outVal2, outVal3 );
Log.print( outVal[0] == 1111 && outVal2[0] == 1222 && outVal3[0] == " another string",
     "testout_methodMulParams2");

oletest.testout_methodMulParams3( "hallo", outVal );
Log.print( outVal[0] == "Out Hallo!", "testout_methodMulParams3");

var in1= 3.14;
var in2= 1111;
var in3= -2222;
oletest.testout_methodMulParams4( in1, outVal, in2, outVal2, in3 );
Log.print( (outVal[0] > 4.13 && outVal[0] < 4.15) && (outVal2[0] == 1112), "testout_methodMulParams4");

oletest.testout_methodXInterface( outVal );
var obj= outVal[0];
Log.print( outVal[0].AttrAny2 == "Property Any", "testout_methodXInterface");

document.writeln("<p>");


outVal[0]= 100;
oletest.testinout_methodByte( outVal );
Log.print( outVal[0] == 101, "testinout_methodByte");

outVal[0]= 3.14;
oletest.testinout_methodFloat( outVal );
Log.print( outVal[0] > 4.13 && outVal[0] < 4.15, "testinout_methodFloat");

outVal[0]= 3.14;
oletest.testinout_methodDouble( outVal );
Log.print( outVal[0] > 4.13 && outVal[0] < 4.15, "testinout_methodDouble");

outVal[0]= false;
oletest.testinout_methodBool( outVal );
Log.print( outVal[0] == true, "testinout_methodBool");

outVal[0]= 200;
oletest.testinout_methodShort( outVal );
Log.print( outVal[0] == 201, "testinout_methodShort");

outVal[0]= 300;
oletest.testinout_methodUShort( outVal );
Log.print( outVal[0] == 301, "testinout_methodUShort");

outVal[0]= 400;
oletest.testinout_methodLong( outVal );
Log.print( outVal[0] == 401, "testinout_methodLong");

outVal[0]= 500;
oletest.testinout_methodULong( outVal );
Log.print( outVal[0] == 501, "testinout_methodULong");

outVal[0]= "A";
oletest.testinout_methodChar( outVal );
Log.print( outVal[0] == 66, "testinout_methodChar");

outVal[0]= "I am a string";
oletest.testinout_methodString( outVal );
Log.print( outVal[0] == "I am a string out string", "testinout_methodString");

outVal[0]= arrInt;
oletest.testinout_methodAny( outVal ); 
var arr2= new VBArray( outVal[0]).toArray();
Log.print( isEqualAr(arrInt, arr2), "testinout_methodAny");

outVal[0]= arrInt;
oletest.testinout_methodSequence( outVal );
arr= new VBArray( outVal[0]).toArray();
Log.print( isEqualAr( arr, new Array( 2,3,4,5,6)), "testinout_methodSequence");
		 

outVal[0]= arrSeq;
oletest.testinout_methodSequence2( outVal );
var arr= new VBArray( outVal[0]).toArray();
var i;
bOk= true;
if( arr.length == 3)
{
    var tmpArr= new Array(2,4,6,8,0);
    for( i=0; i < arr.length; i++)
    {
        var arr2= new VBArray( arr[i]).toArray();
        if( ! isEqualAr( arr2, tmpArr))
        {
            bOk= false;
            break;
        }
    }
}
Log.print( bOk, "testinout_methodSequence2");


var ob=  new Object();
var sInVal= "this is a string"
ob.value= sInVal;
outVal[0]= ob;
oletest.testinout_methodXInterface( outVal);
Log.print( outVal[0].value == " this string was written in the UNO component to the inout pararmeter", "testinout_methodXInterface");

document.writeln("<p>");


Log.summarize();




function Logger()
{
    this.print= logger_print;
    this.summarize= logger_summarize;
    this.bAllOk= true;
}
function logger_print( bool, method)
{
    if( bool)
        document.writeln( "Ok &nbsp;&nbsp;&nbsp;&nbsp;" + arFunctions[method] + "<br>");
    else
    {
        document.writeln( "Failed &nbsp;&nbsp;&nbsp;&nbsp;" + arFunctions[method] + "<br>");
        this.bAllOk= this.bAllOk && false;
    }
}

function logger_summarize()
{
    document.writeln("<p> ==============================================================================<br>");
    if(this.bAllOk)
        document.writeln("No errors <br>");
    else
        document.writeln("Error ! The test failed! <br>");
}
    
function isEqualAr( ar1, ar2)
{
    var bOk= false;
    if( ar1.length == ar2.length)
    {
        bOk= true;
        for( x in ar1)
        {
/*             document.writeln( ar1[x] + " "); */
/*              document.writeln( ar2[x] + " "); */
            if( ar1[x] != ar2[x])
            {
                bOk= false;
                break;
            }
        }
    }
    return bOk;
}

/* function isEqualAr2( ar1, ar2) */
/* { */

/*     var bOk= false; */
/*     if( ar1.length == ar2.length) */
/*     { */
/*         bOk= true; */
/*         for( x in ar1) */
/*         { */
/*             document.write( ar1[x]); */
/*             document.write( ar2[x]); */
/*             if( ! isEqualAr( ar1[x], ar2[x])) */
/*            { */
/*                bOk= false; */
/*                break; */
/*            } */
/*         } */
/*     } */
/*     return bOk; */

/* } */
    
function XEventListener_Impl()
{
	this._environment= "JScript";
	this._implementedInterfaces= new Array( "com.sun.star.lang.XEventListener");

	//XEventListener
	this.disposing= XEventListener_disposing;
	
	this.bdisposingCalled= false;
	this.bQuiet= true;
	this.resetDisposing= XEventListener_resetDisposing;
	this.disposingCalled= XEventListener_disposingCalled;
}	

function XEventListener_disposing( source)
{
  if( !this.bQuiet)
        alert("JScript Event Listener \n disposing is being called");
  this.bdisposingCalled= true;
}

function XEventListener_resetDisposing()
{
   this.bdisposingCalled= false;
}

function XEventListener_disposingCalled()
{
     return this.bdisposingCalled;
}

//--------------------------------------------------------------------------------------------
function callOleTest(	 id)
{   
	var factory= new ActiveXObject("com.sun.star.ServiceManager");
	var oletest= factory.createInstance("oletest.OleTest");
//	alert(oletest);
		
	var arr= new Array( 1, 2, 3, 4, 0);
	var arrDouble= new Array( 1.2345, 12.345, 123,45, 1234.5, 12345);
	var arrBool= new Array( 1, 0, 2, 0, 3);
	var arrChar= new Array( '1', 'A', "1", "A", ' ', 55, 56);
	var arrString= new Array("hamburger","cheeseburger", "chicken nuggets", "chicken wings" , "pizza");
	var arrAny= new Array( 100, 100.1235,"hallo");
	var arrSeq= new Array( arr, arr, arr);
	var arrSeq2= new Array( arrSeq, arrSeq, arrSeq)

	
	var arrout1= new Array();
	var arrout2= new Array();
	var arrout3= new Array();

	var ret, i;
	var sfarray, sfarray1, sfarray2, sfarray3;
	var arEventListener= new Array( new XEventListener_Impl(), new XEventListener_Impl(),
	                                new XEventListener_Impl());
	var arEventListener2= new Array( new XEventListener_Impl(), new XEventListener_Impl(),
	                                new XEventListener_Impl());
	var arArEventListener= new Array( arEventListener, arEventListener2);
	switch( id)
	{
	// Array in-param


	
	// Test ANY
	// Methods
	case 1000:
		i= 100;
		ret= oletest.methodAnyTest1( i);
		document.writeln( "in: " + i + " ret: " + ret);
		break;
	case 1001: 
		i= 3.14;
		ret= oletest.methodAnyTest1( i);
		document.writeln( "in: " + i + " ret: " + ret);
		break;
	case 1002:
		i= "Hallo"
		ret= oletest.methodAnyTest1( i);
		document.writeln( "in: " + i + " ret: " + ret);
		break;
	case 1003:
		i= arr;
		ret= oletest.methodAnyTest1( i);
		sfarray= new VBArray( ret);
		document.writeln( "in: " + i + " ret: " + sfarray.toArray());
		break;
	case 1004:
		var obj= new Object();
		obj[1]= "This is index 0";
		ret= oletest.methodAnyTest1( obj);
		document.writeln( "in: " + obj + " ret: " + ret);
		break;


	// Test ANY property
	case 1010:
		i= 100;
		oletest.AttrAny2= i;
		ret= oletest.AttrAny2;
		document.writeln( "set: " + i + " get: " + ret);
		break;
	case 1011: 
		i= 3.14;
		oletest.AttrAny2= i;
		ret= oletest.AttrAny2;
		document.writeln( "set: " + i + " get: " + ret);
		break;
	case 1012:
		i= "Hallo"
		oletest.AttrAny2= i;
		ret= oletest.AttrAny2;
		document.writeln( "set: " + i + " get: " + ret);
		break;
	case 1013:
		i= arr;
		oletest.AttrAny2= i;
		ret= oletest.AttrAny2;
		sfarray= new VBArray( ret);
		document.writeln( "set: " + i + " get: " + sfarray.toArray());
		break;
	case 1014:
		var obj= new Object();
		obj[1]= "This is index 0";
		oletest.AttrAny2= obj;
		ret= oletest.AttrAny2;
		document.writeln( "set: " + obj + " get: " + ret);
		break;
	
	// Structs ----------------------------------------------
	case 1020:
		 var struct= oletest._GetStruct("com.sun.star.beans.Property");
		 struct.Attributes= 1;
		 struct.Handle= 2;
		 struct.Name= "some Property"
		 oletest.methodStruct( struct);
		 break;
	case 1021:
		var struct= oletest.retMethodStruct();
		alert( "Property::Attributes : " + struct.Attributes + " \nProperty::Handle : "
		+ struct.Handle + "\n Property::Name : " + struct.Name);
		break;
	case 1022:
		 var struct= oletest._GetStruct("com.sun.star.beans.Property");
		 struct.Attributes= 1;
		 struct.Handle= 2;
		 struct.Name= "some Property"
		 oletest.AttrStruct=  struct;

		 var struct2= oletest.AttrStruct;
		alert( "property get: \n Property::Attributes : " + struct2.Attributes + " \nProperty::Handle : "
		+ struct2.Handle + "\n Property::Name : " + struct2.Name);
		break;

	case 2100:
		alert("2100");
		var ret= oletest.retMethodByte();
		var sfarray= VBArray( ret);
		document.writeln( sfarray.toArray() );
		break;



	}

}

function funcOut( out)
{
	out["du"]= 0xffff;
}

</script>

<script language="VBScript">

sub callBasic(id)
	
	Dim factory
	Set	factory= GetObject("", "com.sun.star.ServiceManager")

	Set	oletest= factory.createInstance("oletest.OleTest")


	arrInt= Array(1,2,3,4,5)
	arrInt2= Array( -1, -2, 127, 128, 0)
	arrDouble= Array(1.1, 2.2, 3.3, 4.4, 5.5)
	arrBool= Array(0,1,0,2,0)
	arrLong= Array( &Hff, &Hffff, &Hffffff, &Hffffffff)
	arrString= Array("Chicken Wings", "Cheeseburger", "Hamburger")
	arrChar= Array("a",65, "M")
	arrAny= Array("Mickey", 3.14, 100, "A")

	Dim arrDim2Int(1,1)
	For i= 0 To 1
		For j= 0 To 1
			arrDim2Int(i,j) = i*2 + j
		Next
	Next
	
	Dim arrDim3Int(1,1,1)
	For i= 0 To 1
		For j= 0 To 1
			For k=0 To 1
				arrDim3Int(i,j,k) = i*2 + j*2 + k
			Next
		Next
	Next

	
	select case id
		case 0 
			document.writeln "param: "
			printArray arrInt
			ret= oletest.methodByte(arrInt)
			document.writeln "<br> return value: "
			printArray ret
		case 1
			document.writeln "param: "
			printArray arrDouble
			ret= oletest.methodDouble(arrDouble)
			document.writeln "<br> return value: "
			printArray ret
		case 2
			document.writeln "param: "
			printArray arrBool
			ret= oletest.methodBool(arrBool)
			document.writeln "<br> return value: "
			printArray ret
		case 3
			document.writeln "param: "
			printArray arrInt2
			ret= oletest.methodShort(arrInt2)
			document.writeln "<br> return value: "
			printArray ret
		case 4
			document.writeln "param: "
			printArray arrInt
			ret= oletest.methodUShort(arrInt)
			document.writeln "<br> return value: "
			printArray ret
		case 5
			document.writeln "param: "
			printArray arrLong
			ret= oletest.methodLong(arrLong)
			document.writeln "<br> return value: "
			printArray ret
		case 6
			document.writeln "param: "
			printArray arrInt
			ret= oletest.methodULong(arrInt)
			document.writeln "<br> return value: "
			printArray ret
		case 7
			document.writeln "param: "
			printArray arrString
			ret= oletest.methodString(arrString)
			document.writeln "<br> return value: "
			printArray ret
		case 8
			document.writeln "param: "
			printArray arrChar
			ret= oletest.methodChar(arrChar)
			document.writeln "<br> return value: "
			printArray ret
		case 9
			document.writeln "param: "
			printArray arrAny
			ret= oletest.methodAny(arrAny)
			document.writeln "<br> return value: "
			printArray ret
		case 10
			document.writeln "param: "
			printArray2 arrDim2Int
			ret= oletest.methodSequence(arrDim2Int)
			document.writeln "<br> return value: "
			for each val in ret
				document.write "<br> array: "
				for each val2 in val
					document.write val2
				next
			next

	// Out Parameter
		case 150
			dim rOut
			oletest.testout_methodByte rOut 
			MsgBox rOut
//	void testout_methodFloat( [out] float rOut);
//	void testout_methodDouble( [out] double rOut);
//	void testout_methodBool( [out] boolean rOut);
//	void testout_methodShort( [out] short rOut);
//	void testout_methodUShort( [out] unsigned short rOut);
//	void testout_methodLong( [out]  long rOut);
//	void testout_methodULong( [out] unsigned long rOut);


 // In Out Parameter --------------------------------------------------
		case 100
			a= 100
			document.write "param: " & CStr(  a) & "<br>"
			oletest.testinout_methodByte a
			document.write a 
		case 101
			a= 1.11
			document.write "param: " & CStr(  a) & "<br>"
			oletest.testinout_methodDouble a
			document.write a 
		case 102
			a= 5
			document.write "param: "& CStr(  a) & "<br>"
			oletest.testinout_methodBool a
			document.write a 
		case 103
			a= -10
			document.write "param: "& CStr(  a) & "<br>"
			oletest.testinout_methodShort a
			document.write a 
		case 104
			a= 128
			document.write "param: "& CStr(  a) & "<br>"
			oletest.testinout_methodUShort a
			document.write a 
		case 105
			a= 65556
			document.write "param: "& CStr(  a) & "<br>"
			oletest.testinout_methodLong a
			document.write a 
		case 106
			a= 65556
			document.write "param: "& CStr(  a) & "<br>"
			oletest.testinout_methodULong a
			document.write a 
		case 107
			a= "ein test string"
			document.write "param: "& CStr(  a) & "<br>"
			oletest.testinout_methodString a
			document.write a 
		case 108
			a= "W"
			document.write "param: "& CStr(  a) & "<br>"
			oletest.testinout_methodChar a
			document.write a 
		case 109
			a= "Ein String im Any"
			document.write "param: "& CStr(  a) & "<br>"
			oletest.other_methodAnyIn a
			document.write a

		case 150
			dim a
			document.write "param: "& CStr(  a) & "<br>"
			oletest.testout_methodByte( a)
			document.write a
// Attributes -----------------------------------------------------------------
		case 200
			document.write "set: " 
			printArray arrInt 
			oletest.AttrByte= arrInt
			b= oletest.AttrByte
			call printArrayEx( "<br> get: ", "<br>", b)
		case 201
			document.write "set: " 
			printArray arrDouble 
			oletest.AttrDouble= arrDouble
			b= oletest.AttrDouble
			call printArrayEx( "<br> get: ", "<br>", b)
		case 202
			document.write "set: " 
			printArray arrBool : 
			oletest.AttrBool= arrBool
			b= oletest.AttrBool
			call printArrayEx( "<br> get: ", "<br>", b)
		case 203
			document.write "set: " 
			printArray arrInt2 : 
			oletest.AttrShort= arrInt2
			b= oletest.AttrShort
			call printArrayEx( "<br> get: ", "<br>", b)
		case 204
			document.write "set: " 
			printArray arrInt 
			oletest.AttrUShort= arrInt
			b= oletest.AttrUShort
			call printArrayEx( "<br> get: ", "<br>", b)
		case 205
			document.write "set: " 
			printArray arrInt2
			oletest.AttrLong= arrInt2
			b= oletest.AttrLong
			call printArrayEx( "<br> get: ", "<br>", b)
		case 206
			document.write "set: " 
			printArray arrInt 
			oletest.AttrULong= arrInt
			b= oletest.AttrULong
			call printArrayEx( "<br> get: ", "<br>", b)
		case 207
			document.write "set: " 
			printArray arrString 
			oletest.AttrString= arrString
			b= oletest.AttrString
			call printArrayEx( "<br> get: ", "<br>", b)
		case 208
			document.write "set: " 
			printArray arrChar
			oletest.AttrChar= arrChar
			b= oletest.AttrChar
			call printArrayEx( "<br> get: ", "<br>", b)
		case 209
			document.write "set: " 
			printArray arrAny
			oletest.AttrAny= arrAny
			b= oletest.AttrAny
			call printArrayEx( "<br> get: ", "<br>", b)

		case 210
			document.write "set: <br>" 
			printArray2 arrDim2Int : 
			oletest.AttrSequence= arrDim2Int
			ret= oletest.AttrSequence
			document.write "get: "
			for each val in ret
				document.write "<br> array: "
				for each val2 in val
					document.write val2
				next
			next

		case 300
			dim aByte
			aByte= 100
			call oletest.testinout_methodByte( aByte)
			MsgBox aByte 


		case 400
		
		set  struct= oletest.Bridge_GetStruct("com.sun.star.beans.Property")
		 struct.Attributes= 1
		 struct.Handle= 2
		 struct.Name= "some Property"
		 oletest.methodStruct struct

	case 401
		set struct= oletest.retMethodStruct()
		alert( "Property::Attributes : " & struct.Attributes & vblf & " Property::Handle : " _
		& struct.Handle & vblf & " Property::Name : " & struct.Name)

	case 402
		set struct= oletest.Bridge_GetStruct("com.sun.star.beans.Property")
		 struct.Attributes= 1
		 struct.Handle= 2
		 struct.Name= "some Property"
		 oletest.AttrStruct=  struct

		 set struct2= oletest.AttrStruct
		alert( "property get: " & vblf & "Property::Attributes : " & struct2.Attributes & _
		vblf & " Property::Handle : " &  struct2.Handle & vblf & " Property::Name : " _
		& struct2.Name)
	end select
end sub

sub printArray( arr)
	document.write "array: "
	For Each val In arr
		document.write CStr(val) & " "
	Next
end sub

// print a 2 dimensional Array

sub printArray2( arr)
		elements1= UBound( arr, 1) - LBound( arr, 1) +1
		elements2= UBound( arr, 2) - LBound( arr, 2) +1
		
		For i=0 To elements1 -1
			document.write( "array " & CStr( i) & ": "  )
			For j=0 To elements2 -1
				document.write CStr( arr(i,j))
			Next
			document.write( "<br>")
		Next
end sub

sub printArrayEx( pre, post, array)
	document.write pre
	printArray array
	document.write post
end sub
</script>

<div id=out> </div>

<!-- Insert HTML here -->

<h2> JScript </h2>

<p>

<p>

Tests Array/Sequence conversion with Attributes. All params are of type Sequence and 
 the element type of the Sequence is written on the buttons. <br>
<button onclick='callOleTest( 200)'>byte </Button>
<button onclick='callOleTest( 212)'>float</Button>
<button onclick='callOleTest( 201)'>double</Button>
<button onclick='callOleTest( 202)'>boolean</Button>
<button onclick='callOleTest( 203)'>short</Button>
<button onclick='callOleTest( 204)'>unsigned short</Button>
<button onclick='callOleTest( 205)'>long</Button>
<button onclick='callOleTest( 206)'>unsigned long</Button>
<button onclick='callOleTest( 207)'>char</Button>
<button onclick='callOleTest( 208)'>string</Button>
<button onclick='callOleTest( 209)'>any</Button>
<button onclick='callOleTest( 210)'>sequence&ltlong&gt </Button>
<button onclick='callOleTest( 211)'>sequence&ltsequence&ltlong&gt &gt </Button>
<p>

Test of Any parameter in a method. Any contains:<br>
<button onclick='callOleTest( 1000)'>integer </Button>
<button onclick='callOleTest( 1001)'>double </Button>
<button onclick='callOleTest( 1002)'>string</Button>
<button onclick='callOleTest( 1003)'>array</Button>
<button onclick='callOleTest( 1004)'>object</Button>
<p>
Test of Any parameter in a property. Any contains:<br>
<button onclick='callOleTest( 1010)'>integer </Button>
<button onclick='callOleTest( 1011)'>double </Button>
<button onclick='callOleTest( 1012)'>string</Button>
<button onclick='callOleTest( 1013)'>array</Button>
<button onclick='callOleTest( 1014)'>object</Button>
<P>
Test of Struct conversions<br>
<button onclick='callOleTest( 1020)'>methodStruct </Button>
<button onclick='callOleTest( 1021)'>return struct</Button>
<button onclick='callOleTest( 1022)'>struct attribute</Button>




<p>


<h2> Visual Basic Tests </h2>
Test array /Sequence conversion and return value<br>
Template: <b> Sequence &lt type &gt method( Sequence&lt type &gt ) </b> <br>
<!--<font color= red>Multi dimensional arrays are not processed by VBSript</font> <br>  -->
<button onclick='callBasic(0)'>byte</button>
<button onclick='callBasic(1)'>double</button>
<button onclick='callBasic(2)'>boolean</button>
<button onclick='callBasic(3)'>short</button>
<button onclick='callBasic(4)'>u short</button>
<button onclick='callBasic(5)'>long</button>
<button onclick='callBasic(6)'>u long</button>
<button onclick='callBasic(7)'>string</button>	 
<button onclick='callBasic(8)'>char</button>	
<button onclick='callBasic(9)'>any</button> <br>
<button onclick='callBasic(10)'>Seq &lt int &gt</button> <br>


IN/Out parameter <br>
Template: <b> void method(type  ) </b> <br>
<button onclick='callBasic(100)'>byte</button>
<button onclick='callBasic(101)'>double</button>
<button onclick='callBasic(102)'>boolean</button>
<button onclick='callBasic(103)'>short</button>
<button onclick='callBasic(104)'>u short</button>
<button onclick='callBasic(105)'>long</button>
<button onclick='callBasic(106)'>u long</button>
<button onclick='callBasic(107)'>string</button>	 
<button onclick='callBasic(108)'>char</button>	
<button onclick='callBasic(109)'>any</button> <br>

Simple out parameter<br>
<button onclick='callBasic(150)'>byte</button>
<!--<button onclick='callBasic(151)'>double</button>
<button onclick='callBasic(152)'>boolean</button>
<button onclick='callBasic(153)'>short</button>
<button onclick='callBasic(155)'>long</button>
<button onclick='callBasic(157)'>string</button>	 
<button onclick='callBasic(158)'>char</button>	
<button onclick='callBasic(159)'>any</button> <br>
//-->
<br>


Tests Array/Sequence conversion with <b>Attributes</b>. All params are of type Sequence and 
 the element type of the Sequence is written on the buttons. <br>
<button onclick='callBasic( 200)'>byte </Button>
<button onclick='callBasic( 201)'>double</Button>
<button onclick='callBasic( 202)'>boolean</Button>
<button onclick='callBasic( 203)'>short</Button>
<button onclick='callBasic( 204)'>unsigned short</Button>
<button onclick='callBasic( 205)'>long</Button>
<button onclick='callBasic( 206)'>unsigned long</Button>
<button onclick='callBasic( 207)'>string</Button>
<button onclick='callBasic( 208)'>char</Button>
<button onclick='callBasic( 209)'>any</Button>
<button onclick='callBasic( 210)'>sequence&ltlong&gt </Button> <br>

In Out parameter <br>
<button onclick='callBasic( 300)'>byte</Button>
<p>
Structs <br>
<button onclick='callBasic(400)'>methodStruct</button>
<button onclick='callBasic(401)'>return Struct</button>
<button onclick='callBasic(402)'>struct attribute</button>



