
# executables are *.exe for WNT. This variable is necessary since Cygwin 1.5.x
if test "$GUI" = "WNT"; then
  export EXEEXT=".exe"
else
  export EXEEXT=""
fi

if test "$BUILD_DMAKE" != "NO"; then

  if test ! -e "$SOLARENV/$OUTPATH/bin/dmake$EXEEXT"; then

  cd "$SRC_ROOT/dmake" || exit

  # Special case! The w32/tcsh build needs CC pointing to the MSVC++ compiler
  # but we need a cygwin/gcc build dmake to understand the posix paths
  if test "$GUI" = "WNT" -a "$USE_SHELL" != "4nt"; then
    export CC=""
    export CXX=""
  fi

  # For the W32/4nt case
  rm -rf objects

  # For normal unixy systems
  if test -e "Makefile" ; then
    $GNUMAKE distclean || exit
  fi

  ./configure || exit

  ## invoke the gnu make command set by configure.
  $GNUMAKE || exit

  echo ""
  echo "dmake has been successfully built"

  cd ..

  else

  echo ""
  echo "dmake present in $SOLARENV/$OUTPATH/bin/dmake$EXEEXT"

  fi

fi

# unalias these commands if they are aliased

mkdir -p "$SOLARENV/$OUTPATH/bin"
if test "$BUILD_DMAKE" != "NO"; then
  cp -f "$SRC_ROOT/dmake/dmake$EXEEXT" "$SOLARENV/$OUTPATH/bin" || exit
  echo ""
  echo "dmake copied to $SOLARENV/$OUTPATH/bin/dmake$EXEEXT"
fi

#make sure build.pl is executable 

chmod +x "$SRC_ROOT/solenv/bin/build.pl"
chmod +x "$SRC_ROOT/solenv/bin/zipdep.pl"
chmod +x "$SRC_ROOT/solenv/bin/gccinstlib.pl"
