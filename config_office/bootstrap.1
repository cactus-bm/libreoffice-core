# executables are *.exe for WNT. This variable is necessary since Cygwin 1.5.x
if ( "$GUI" == "WNT" ) then
  setenv EXEEXT ".exe"
else
  setenv EXEEXT ""
endif

if ( "$BUILD_DMAKE" != "NO" ) then

  if ( ! -e $SOLARENV/$OUTPATH/bin/dmake$EXEEXT ) then

  cd $SRC_ROOT/dmake
  if "$?" != "0" exit $?

  # Special case! The w32/tcsh build needs CC pointing to the MSVC++ compiler
  # but we need a cygwin/gcc build dmake to understand the posix paths
  if ( $GUI == "WNT" && $USE_SHELL == "tcsh" ) then
    setenv CC ""
    setenv CXX ""
  endif

  # For the W32/4nt case
  if ( -d objects ) then
    rm -rf objects
    if "$?" != "0" exit $?
  endif
  # For normal unixy systems
  if ( -e Makefile ) then
    $GNUMAKE distclean
    if "$?" != "0" exit $?
  endif

  ./configure
  if "$?" != "0" exit $?

  ## invoke the gnu make command set by configure.
  $GNUMAKE
  if "$?" != "0" exit $?

  echo ""
  echo "dmake has been successfully built"

  cd ..

  endif

endif
